\hypertarget{thread_8c}{\section{src/kernel/thread.c File Reference}
\label{thread_8c}\index{src/kernel/thread.\-c@{src/kernel/thread.\-c}}
}
{\ttfamily \#include $<$caribou/kernel/thread.\-h$>$}\\*
{\ttfamily \#include $<$caribou/kernel/timer.\-h$>$}\\*
{\ttfamily \#include $<$caribou/kernel/interrupt.\-h$>$}\\*
{\ttfamily \#include $<$caribou/lib/queue.\-h$>$}\\*
{\ttfamily \#include $<$caribou/lib/heap.\-h$>$}\\*
{\ttfamily \#include $<$caribou/lib/string.\-h$>$}\\*
{\ttfamily \#include $<$caribou/lib/errno.\-h$>$}\\*
{\ttfamily \#include $<$chip/chip.\-h$>$}\\*
{\ttfamily \#include $<$cpu/cpu.\-h$>$}\\*
Include dependency graph for thread.\-c\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{thread_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{thread_8c_a0ebb1b5add3128c389a638c2654342c4}{systick\-\_\-enter}()
\begin{DoxyCompactList}\small\item\em Defines the steps to run on entry to a systick I\-S\-R. \end{DoxyCompactList}\item 
\#define \hyperlink{thread_8c_ae0283c4e97b490d0120dbcee2c16e826}{systick\-\_\-exit}()
\begin{DoxyCompactList}\small\item\em the steps to run on exit from a systick I\-S\-R \end{DoxyCompactList}\item 
\#define \hyperlink{thread_8c_ad2e99d98cbfa634e4ed8d16e58f0df01}{pendsv\-\_\-enter}()
\begin{DoxyCompactList}\small\item\em Defines the steps to run on entry to a pendsv I\-S\-R. \end{DoxyCompactList}\item 
\#define \hyperlink{thread_8c_ad9389d3bc148d07e170d4f53c1a33279}{pendsv\-\_\-exit}()
\begin{DoxyCompactList}\small\item\em the steps to run on exit from a pendsv I\-S\-R \end{DoxyCompactList}\item 
\#define \hyperlink{thread_8c_aefad00b22e3f7c5d2d56a682b7e20a20}{runnable}(thread)~((thread-\/$>$state \& \hyperlink{thread_8h_af8a8cccb25f4f9e279d5053eb2cfabd8}{C\-A\-R\-I\-B\-O\-U\-\_\-\-T\-H\-R\-E\-A\-D\-\_\-\-F\-\_\-\-I\-D\-L\-E\-\_\-\-M\-A\-S\-K}) == 0)
\begin{DoxyCompactList}\small\item\em determine if the thread is in a runnable state \end{DoxyCompactList}\item 
\#define \hyperlink{thread_8c_a135bcecaced3029cead465910bc2caa9}{preemptable}(thread)~(thread-\/$>$lock==0)
\begin{DoxyCompactList}\small\item\em determine of the thread can be preempted at this time. \end{DoxyCompactList}\item 
\#define \hyperlink{thread_8c_a0b5c64c9361194055a65a234b62e5517}{nextinqueue}(thread)~( thread-\/$>$next ? thread-\/$>$next \-: caribou\-\_\-state.\-queue )
\begin{DoxyCompactList}\small\item\em find the next thread in the queue \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static void \hyperlink{thread_8c_a84c100abfd8a8df4f85158a8a2f26321}{runtimers} ()
\begin{DoxyCompactList}\small\item\em Forward declaration for the private \hyperlink{thread_8c_a84c100abfd8a8df4f85158a8a2f26321}{runtimers()} function. \end{DoxyCompactList}\item 
static uint16\-\_\-t \hyperlink{thread_8c_a0b72fd6b15677067d5d231ace4070498}{fault\-\_\-clear} (void)
\begin{DoxyCompactList}\small\item\em Clear the fault flags. The current thread is locked prior to setting the lags, and is unlocked after the flags have been set. \end{DoxyCompactList}\item 
static uint16\-\_\-t \hyperlink{thread_8c_a2e21dedab93924499a818d5919126b21}{fault\-\_\-set} (uint16\-\_\-t flags)
\begin{DoxyCompactList}\small\item\em Set a fault flag. The current thread is locked prior to setting the lags, and is unlocked after the flags have been set. \end{DoxyCompactList}\item 
uint16\-\_\-t \hyperlink{thread_8c_a06622b3e7de7c548f6c011ec10d03cef}{\-\_\-caribou\-\_\-thread\-\_\-fault\-\_\-emit} (uint16\-\_\-t flags)
\begin{DoxyCompactList}\small\item\em Emit a thread fault by calling the faultfn callback function. \end{DoxyCompactList}\item 
void \hyperlink{thread_8c_ad0596139a6bb38fc3c12be06a9180c4d}{caribou\-\_\-thread\-\_\-dump} ()
\item 
static \hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$ \hyperlink{thread_8c_aad2dda8acbccc8a86e400143d1ac913c}{new\-\_\-thread\-\_\-node} (\hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$parent)
\begin{DoxyCompactList}\small\item\em Allocate and initialize a thread node. \end{DoxyCompactList}\item 
static void \hyperlink{thread_8c_aef758d9fcc426b2069d6e5ed7ed2ed0f}{delete\-\_\-thread\-\_\-node} (\hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$node)
\begin{DoxyCompactList}\small\item\em Dispose of a thread node. \end{DoxyCompactList}\item 
static \hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$ \hyperlink{thread_8c_a8dd1c0055ec5da06cf9eeeafc09c7aa7}{append\-\_\-thread\-\_\-node} (\hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$node)
\begin{DoxyCompactList}\small\item\em Append a thread node to the list. \end{DoxyCompactList}\item 
static \hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$ \hyperlink{thread_8c_a457d03e540372537caa26ddc9244ca15}{insert\-\_\-thread\-\_\-node} (\hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$node, \hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$after)
\begin{DoxyCompactList}\small\item\em Append a thread node to the list. \end{DoxyCompactList}\item 
static \hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$ \hyperlink{thread_8c_afc25d21e4e56f62c9dcd93e86225c863}{remove\-\_\-thread\-\_\-node} (\hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$node)
\begin{DoxyCompactList}\small\item\em Remove a thread node from the list. \end{DoxyCompactList}\item 
static \hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$ \hyperlink{thread_8c_a5cecb0c75bb0ab2a0a4b1f1e30d6c5bf}{find\-\_\-child\-\_\-thread\-\_\-node} (\hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$parent)
\begin{DoxyCompactList}\small\item\em locate next child \end{DoxyCompactList}\item 
int \hyperlink{thread_8c_a81ec8b7e5f2accca0c462337830fbdf5}{caribou\-\_\-thread\-\_\-lock} (void)
\begin{DoxyCompactList}\small\item\em Lock the current thread such that it will not yield C\-P\-U time until such time that the thread is unlocked by \hyperlink{thread_8c_a0b4d0cd341028e7713f6f0f60a018529}{caribou\-\_\-thread\-\_\-unlock()}. Needless to say this should generally be used sparingly. \end{DoxyCompactList}\item 
int \hyperlink{thread_8c_a0b4d0cd341028e7713f6f0f60a018529}{caribou\-\_\-thread\-\_\-unlock} (void)
\begin{DoxyCompactList}\small\item\em Unlock a thread which has been previously been locked with \hyperlink{thread_8c_a81ec8b7e5f2accca0c462337830fbdf5}{caribou\-\_\-thread\-\_\-lock()} \end{DoxyCompactList}\item 
int \hyperlink{thread_8c_a013385b5f8859b297532a624c53e3425}{caribou\-\_\-thread\-\_\-locked} (\hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$thread)
\begin{DoxyCompactList}\small\item\em Determine of the current thread is locked? \end{DoxyCompactList}\item 
void \hyperlink{thread_8c_a58f74a5d00bc66769898ee8ea9df8c4e}{caribou\-\_\-thread\-\_\-sleep} (\hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$thread, \hyperlink{timer_8h_a905a26361b93888fedb5a0bf658e50e8}{caribou\-\_\-tick\-\_\-t} ticks)
\item 
void \hyperlink{thread_8c_a8ec8d3ea7e7b5f2e9af43bdec60e2e00}{caribou\-\_\-thread\-\_\-sleep\-\_\-current} (\hyperlink{timer_8h_a905a26361b93888fedb5a0bf658e50e8}{caribou\-\_\-tick\-\_\-t} ticks)
\item 
void \hyperlink{thread_8c_ac48bcd661762d85fe2197d29f65b20b7}{caribou\-\_\-thread\-\_\-wakeup} (\hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$thread)
\item 
const char $\ast$ \hyperlink{thread_8c_a951b092d28660f5e3a9893d671c4c6a6}{caribou\-\_\-thread\-\_\-set\-\_\-name} (\hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$thread, const char $\ast$name)
\begin{DoxyCompactList}\small\item\em Set a pointer to the thread's name. \end{DoxyCompactList}\item 
const char $\ast$ \hyperlink{thread_8c_a7844554aa2275022d4376aafe8e55133}{caribou\-\_\-thread\-\_\-name} (\hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$thread)
\begin{DoxyCompactList}\small\item\em return the thread name pointer \end{DoxyCompactList}\item 
uint64\-\_\-t \hyperlink{thread_8c_a90c760a6e205cfb112f2f9cef25da878}{caribou\-\_\-thread\-\_\-runtime} (\hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$thread)
\begin{DoxyCompactList}\small\item\em return the thread's runtime in jiffies \end{DoxyCompactList}\item 
uint32\-\_\-t \hyperlink{thread_8c_a9f72098ff907a9804be262770df5983f}{caribou\-\_\-thread\-\_\-stacksize} (\hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$thread)
\begin{DoxyCompactList}\small\item\em return the thread's stack size in bytes. \end{DoxyCompactList}\item 
uint32\-\_\-t \hyperlink{thread_8c_a793c0c72a1bb908848ef2e3353167768}{caribou\-\_\-thread\-\_\-stackusage} (\hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$thread)
\begin{DoxyCompactList}\small\item\em return the task's stack usage in bytes. \end{DoxyCompactList}\item 
uint16\-\_\-t \hyperlink{thread_8c_aa035cea6301e74d288e0d3f37d6759a2}{caribou\-\_\-thread\-\_\-state} (\hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$thread)
\begin{DoxyCompactList}\small\item\em return the task's state \end{DoxyCompactList}\item 
\hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$ \hyperlink{thread_8c_a0699ae479cf385b908f07e667cde6644}{caribou\-\_\-thread\-\_\-parent} (\hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$thread)
\begin{DoxyCompactList}\small\item\em return the parent thread \end{DoxyCompactList}\item 
void \hyperlink{thread_8c_a148dbcc4c04bf688168d217bc97730a2}{caribou\-\_\-thread\-\_\-wfi} ()
\begin{DoxyCompactList}\small\item\em A wrapper for the hardware \char`\"{}\-Wait For Interrupt\char`\"{} function chip\-\_\-wfi(). \end{DoxyCompactList}\item 
void \hyperlink{thread_8c_a09bcca24ab734199ef4456405771e2ad}{caribou\-\_\-thread\-\_\-yield} (void)
\begin{DoxyCompactList}\small\item\em The remainder of the scheduled time slots for the current thread are disposed and the next runnable thread in the queue is scheduled. \end{DoxyCompactList}\item 
void \hyperlink{thread_8c_a005298b8a4907a4f4523925d7ed1a8f4}{caribou\-\_\-thread\-\_\-terminate} (\hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$thread)
\begin{DoxyCompactList}\small\item\em Schedules a thread to be terminate upon the next execution of the main thread idle loop. The thread's finish callback is executed, in which case the thread is responsible for releasing any resources it may have allocated. Thread timers will automatically be stopped and disposed. \end{DoxyCompactList}\item 
void \hyperlink{thread_8c_af746aba071850ea86575dcef750949d0}{thread\-\_\-finish} (void)
\begin{DoxyCompactList}\small\item\em Get here if a thread returns from it's run() function, wait to die. \end{DoxyCompactList}\item 
\hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$ \hyperlink{thread_8c_a1a176f9b6f0b652714102398843d51ef}{caribou\-\_\-thread\-\_\-create} (const char $\ast$name, void($\ast$run)(void $\ast$), void($\ast$finish)(void $\ast$), void $\ast$arg, void $\ast$stackaddr, int stack\-\_\-size, int16\-\_\-t priority)
\item 
void \hyperlink{thread_8c_a38170ad74ec44557654ee5f3996e10f5}{caribou\-\_\-thread\-\_\-fault\-\_\-set} (void $\ast$($\ast$fn)(int, void $\ast$), void $\ast$arg)
\begin{DoxyCompactList}\small\item\em set the thread fault callback handler \end{DoxyCompactList}\item 
\hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$ \hyperlink{thread_8c_a1697829758e997aa744256133717a13f}{caribou\-\_\-thread\-\_\-root} (void)
\item 
\hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$ \hyperlink{thread_8c_a57862b2b48ff010a38d00f9138ff9696}{caribou\-\_\-thread\-\_\-current} (void)
\item 
\hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$ \hyperlink{thread_8c_a82b0c80119cc0a82b8dbfed125a4200d}{caribou\-\_\-thread\-\_\-first} (void)
\item 
void $\ast$ \hyperlink{thread_8c_a36874085bf0027e821273e0b80e34f0d}{caribou\-\_\-thread\-\_\-current\-\_\-arg} (void)
\begin{DoxyCompactList}\small\item\em return current thread arg \end{DoxyCompactList}\item 
void \hyperlink{thread_8c_abc2776e9b90a3d12dd21aeafcf7149fc}{caribou\-\_\-thread\-\_\-set\-\_\-priority} (\hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$thread, int16\-\_\-t prio)
\begin{DoxyCompactList}\small\item\em Set the priority of the current thread. \end{DoxyCompactList}\item 
int16\-\_\-t \hyperlink{thread_8c_ad54c3c302155c7e96aea192b84ac9849}{caribou\-\_\-thread\-\_\-priority} (\hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$thread)
\item 
\hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$ \hyperlink{thread_8c_aff2beb27359679c25e9a01c1d0bf0f88}{caribou\-\_\-thread\-\_\-init} (int16\-\_\-t priority)
\begin{DoxyCompactList}\small\item\em Initialize the thread system with priority of main thread, this creates the main 'caribou' thread. \end{DoxyCompactList}\item 
void \hyperlink{thread_8c_a6880536f791e0362675c3b11a9f2d2fb}{caribou\-\_\-thread\-\_\-schedule} (\hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$thread)
\begin{DoxyCompactList}\small\item\em Schedule a thread to run next. The specified thread will be queued to run on the next context switch. If it is desired to schedule the thread to run immediately, then follow the \hyperlink{thread_8c_a6880536f791e0362675c3b11a9f2d2fb}{caribou\-\_\-thread\-\_\-schedule()} call with a call to \hyperlink{thread_8c_a09bcca24ab734199ef4456405771e2ad}{caribou\-\_\-thread\-\_\-yield()}. \end{DoxyCompactList}\item 
\hyperlink{thread_8c_af9aace1b44b73111e15aa39f06f43456}{\-\_\-\-\_\-attribute\-\_\-\-\_\-} ((weak))
\begin{DoxyCompactList}\small\item\em Main thread idle time processing. This weakly liked function gets called during main (caribou) thread idle time. There is no guaranteed schedule, however, under normal circumstances, the main\-\_\-idle() function should be called with a period of one millisecond. Normally the function over-\/ride resides in main.\-c/pp and must utilize \char`\"{}\-C\char`\"{} linkage. \end{DoxyCompactList}\item 
static void \hyperlink{thread_8c_a3f8a853d30c98c2a756adf6920307208}{check\-\_\-sp} (\hyperlink{thread_8h_a0e341ab77bd872b9b57b065b0f8e9a8e}{caribou\-\_\-thread\-\_\-t} $\ast$thread)
\item 
void \hyperlink{thread_8c_aa85093539f7bb9e2c7124a2011e60279}{caribou\-\_\-thread\-\_\-once} ()
\begin{DoxyCompactList}\small\item\em wait for interrupt \end{DoxyCompactList}\item 
void \hyperlink{thread_8c_aee74a4ed56dec09a5acd9ce8b57de9d8}{caribou\-\_\-thread\-\_\-exec} ()
\begin{DoxyCompactList}\small\item\em Enter into the main thread execution loop. This function does not return. This function should be called once all other threads are created and started. This function has two callbacks board\-\_\-idle() and main\-\_\-idle(). \end{DoxyCompactList}\item 
static void \hyperlink{thread_8c_abca798438c743165fb5b9e06875ed37c}{\-\_\-swap\-\_\-thread} ()
\begin{DoxyCompactList}\small\item\em Performs the thread scheduling function. Currently a round-\/robin search for the next runnable. \end{DoxyCompactList}\item 
void \hyperlink{thread_8c_abe49956df32d79322d93eb548ff139f3}{\-\_\-\-\_\-attribute\-\_\-\-\_\-} ((naked))
\begin{DoxyCompactList}\small\item\em In the case where the current thread is preempted by \hyperlink{thread_8c_a09bcca24ab734199ef4456405771e2ad}{caribou\-\_\-thread\-\_\-yield()}, then there is no jiffies counting, otherwise it's the same as the normal scheduler interrupt. If C\-A\-R\-I\-B\-O\-U\-\_\-\-L\-O\-W\-\_\-\-S\-T\-A\-C\-K\-\_\-\-T\-R\-A\-P is defined, stack overflow trapping is performed. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{structcaribou__state__t}{caribou\-\_\-state\-\_\-t} \hyperlink{thread_8c_a3c2ea18e6c8d46571011cf28be234e15}{caribou\-\_\-state}
\begin{DoxyCompactList}\small\item\em An instance o the current thread state. \end{DoxyCompactList}\item 
uint32\-\_\-t \hyperlink{thread_8c_a4e721aeae2f22d803b0b29e8c82f84cb}{\-\_\-\-\_\-process\-\_\-stack\-\_\-base\-\_\-\-\_\-}
\begin{DoxyCompactList}\small\item\em External reference to the process stack base, normally defined in the linker script. \end{DoxyCompactList}\item 
uint32\-\_\-t \hyperlink{thread_8c_ae60172d0f068a9453447bec8e102bdcb}{\-\_\-\-\_\-process\-\_\-stack\-\_\-end\-\_\-\-\_\-}
\begin{DoxyCompactList}\small\item\em External reference to the process stack end (top), normally defined in the linker script. \end{DoxyCompactList}\item 
uint32\-\_\-t \hyperlink{thread_8c_aa8aa5ad03b209f6ba8bc8c4b5933345f}{\-\_\-\-\_\-main\-\_\-thread\-\_\-stack\-\_\-base\-\_\-\-\_\-}
\begin{DoxyCompactList}\small\item\em External reference to the main thread stack base, normally defined in the linker script. \end{DoxyCompactList}\item 
uint32\-\_\-t \hyperlink{thread_8c_ad7ed8a105e4aa389b28a3d4efd6e7596}{\-\_\-\-\_\-main\-\_\-thread\-\_\-stack\-\_\-end\-\_\-\-\_\-}
\begin{DoxyCompactList}\small\item\em External reference to the main thread stack base (top), normally defined in the linker script. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}




\begin{DoxyAuthor}{Author}
Mike Sharkey \href{mailto:mike@pikeaero.com}{\tt mike@pikeaero.\-com}. 
\end{DoxyAuthor}
\begin{DoxyCopyright}{Copyright}
© 2005-\/2013 by Pike Aerospace Research Corporation 

© 2014-\/2015 by Mike Sharkey
\end{DoxyCopyright}
This file is part of C\-A\-R\-I\-B\-O\-U R\-T\-O\-S C\-A\-R\-I\-B\-O\-U R\-T\-O\-S is free software\-: you can redistribute it and/or modify it under the terms of the Beerware License Version 43. \char`\"{}\-T\-H\-E B\-E\-E\-R-\/\-W\-A\-R\-E L\-I\-C\-E\-N\-S\-E\char`\"{} (Revision 43)\-: Mike Sharkey \href{mailto:mike@pikeaero.com}{\tt mike@pikeaero.\-com} wrote this file. As long as you retain this notice you can do whatever you want with this stuff. If we meet some day, and you think this stuff is worth it, you can buy me a beer in return $\sim$ Mike Sharkey 

Definition in file \hyperlink{thread_8c_source}{thread.\-c}.



\subsection{Macro Definition Documentation}
\hypertarget{thread_8c_a0b5c64c9361194055a65a234b62e5517}{\index{thread.\-c@{thread.\-c}!nextinqueue@{nextinqueue}}
\index{nextinqueue@{nextinqueue}!thread.c@{thread.\-c}}
\subsubsection[{nextinqueue}]{\setlength{\rightskip}{0pt plus 5cm}\#define nextinqueue(
\begin{DoxyParamCaption}
\item[{}]{thread}
\end{DoxyParamCaption}
)~( thread-\/$>$next ? thread-\/$>$next \-: caribou\-\_\-state.\-queue )}}\label{thread_8c_a0b5c64c9361194055a65a234b62e5517}


find the next thread in the queue 



Definition at line 76 of file thread.\-c.

\hypertarget{thread_8c_ad2e99d98cbfa634e4ed8d16e58f0df01}{\index{thread.\-c@{thread.\-c}!pendsv\-\_\-enter@{pendsv\-\_\-enter}}
\index{pendsv\-\_\-enter@{pendsv\-\_\-enter}!thread.c@{thread.\-c}}
\subsubsection[{pendsv\-\_\-enter}]{\setlength{\rightskip}{0pt plus 5cm}\#define pendsv\-\_\-enter(
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{thread_8c_ad2e99d98cbfa634e4ed8d16e58f0df01}
{\bfseries Value\-:}
\begin{DoxyCode}
cpu\_systick\_enter();    \(\backslash\)
        chip\_pendsv\_enter()
\end{DoxyCode}


Defines the steps to run on entry to a pendsv I\-S\-R. 



Definition at line 47 of file thread.\-c.

\hypertarget{thread_8c_ad9389d3bc148d07e170d4f53c1a33279}{\index{thread.\-c@{thread.\-c}!pendsv\-\_\-exit@{pendsv\-\_\-exit}}
\index{pendsv\-\_\-exit@{pendsv\-\_\-exit}!thread.c@{thread.\-c}}
\subsubsection[{pendsv\-\_\-exit}]{\setlength{\rightskip}{0pt plus 5cm}\#define pendsv\-\_\-exit(
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{thread_8c_ad9389d3bc148d07e170d4f53c1a33279}
{\bfseries Value\-:}
\begin{DoxyCode}
chip\_pendsv\_exit(); \(\backslash\)
        cpu\_systick\_exit()
\end{DoxyCode}


the steps to run on exit from a pendsv I\-S\-R 



Definition at line 54 of file thread.\-c.

\hypertarget{thread_8c_a135bcecaced3029cead465910bc2caa9}{\index{thread.\-c@{thread.\-c}!preemptable@{preemptable}}
\index{preemptable@{preemptable}!thread.c@{thread.\-c}}
\subsubsection[{preemptable}]{\setlength{\rightskip}{0pt plus 5cm}\#define preemptable(
\begin{DoxyParamCaption}
\item[{}]{thread}
\end{DoxyParamCaption}
)~(thread-\/$>$lock==0)}}\label{thread_8c_a135bcecaced3029cead465910bc2caa9}


determine of the thread can be preempted at this time. 



Definition at line 74 of file thread.\-c.

\hypertarget{thread_8c_aefad00b22e3f7c5d2d56a682b7e20a20}{\index{thread.\-c@{thread.\-c}!runnable@{runnable}}
\index{runnable@{runnable}!thread.c@{thread.\-c}}
\subsubsection[{runnable}]{\setlength{\rightskip}{0pt plus 5cm}\#define runnable(
\begin{DoxyParamCaption}
\item[{}]{thread}
\end{DoxyParamCaption}
)~((thread-\/$>$state \& {\bf C\-A\-R\-I\-B\-O\-U\-\_\-\-T\-H\-R\-E\-A\-D\-\_\-\-F\-\_\-\-I\-D\-L\-E\-\_\-\-M\-A\-S\-K}) == 0)}}\label{thread_8c_aefad00b22e3f7c5d2d56a682b7e20a20}


determine if the thread is in a runnable state 



Definition at line 72 of file thread.\-c.

\hypertarget{thread_8c_a0ebb1b5add3128c389a638c2654342c4}{\index{thread.\-c@{thread.\-c}!systick\-\_\-enter@{systick\-\_\-enter}}
\index{systick\-\_\-enter@{systick\-\_\-enter}!thread.c@{thread.\-c}}
\subsubsection[{systick\-\_\-enter}]{\setlength{\rightskip}{0pt plus 5cm}\#define systick\-\_\-enter(
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{thread_8c_a0ebb1b5add3128c389a638c2654342c4}
{\bfseries Value\-:}
\begin{DoxyCode}
cpu\_systick\_enter();    \(\backslash\)
        chip\_systick\_enter()
\end{DoxyCode}


Defines the steps to run on entry to a systick I\-S\-R. 



Definition at line 33 of file thread.\-c.

\hypertarget{thread_8c_ae0283c4e97b490d0120dbcee2c16e826}{\index{thread.\-c@{thread.\-c}!systick\-\_\-exit@{systick\-\_\-exit}}
\index{systick\-\_\-exit@{systick\-\_\-exit}!thread.c@{thread.\-c}}
\subsubsection[{systick\-\_\-exit}]{\setlength{\rightskip}{0pt plus 5cm}\#define systick\-\_\-exit(
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{thread_8c_ae0283c4e97b490d0120dbcee2c16e826}
{\bfseries Value\-:}
\begin{DoxyCode}
chip\_systick\_exit();    \(\backslash\)
        cpu\_systick\_exit()
\end{DoxyCode}


the steps to run on exit from a systick I\-S\-R 



Definition at line 40 of file thread.\-c.



\subsection{Function Documentation}
\hypertarget{thread_8c_af9aace1b44b73111e15aa39f06f43456}{\index{thread.\-c@{thread.\-c}!\-\_\-\-\_\-attribute\-\_\-\-\_\-@{\-\_\-\-\_\-attribute\-\_\-\-\_\-}}
\index{\-\_\-\-\_\-attribute\-\_\-\-\_\-@{\-\_\-\-\_\-attribute\-\_\-\-\_\-}!thread.c@{thread.\-c}}
\subsubsection[{\-\_\-\-\_\-attribute\-\_\-\-\_\-}]{\setlength{\rightskip}{0pt plus 5cm}\-\_\-\-\_\-attribute\-\_\-\-\_\- (
\begin{DoxyParamCaption}
\item[{(weak)}]{}
\end{DoxyParamCaption}
)}}\label{thread_8c_af9aace1b44b73111e15aa39f06f43456}


Main thread idle time processing. This weakly liked function gets called during main (caribou) thread idle time. There is no guaranteed schedule, however, under normal circumstances, the main\-\_\-idle() function should be called with a period of one millisecond. Normally the function over-\/ride resides in main.\-c/pp and must utilize \char`\"{}\-C\char`\"{} linkage. 

Main thread idle time processing. This weakly liked function gets called during main (caribou) thread idle time. There is no guaranteed schedule, however, under normal circumstances, the board\-\_\-idle() function should be called with a period of one millisecond. Normally the function over-\/ride resides in board.\-c/pp and must utilize \char`\"{}\-C\char`\"{} linkage. 

Definition at line 642 of file thread.\-c.

\hypertarget{thread_8c_abe49956df32d79322d93eb548ff139f3}{\index{thread.\-c@{thread.\-c}!\-\_\-\-\_\-attribute\-\_\-\-\_\-@{\-\_\-\-\_\-attribute\-\_\-\-\_\-}}
\index{\-\_\-\-\_\-attribute\-\_\-\-\_\-@{\-\_\-\-\_\-attribute\-\_\-\-\_\-}!thread.c@{thread.\-c}}
\subsubsection[{\-\_\-\-\_\-attribute\-\_\-\-\_\-}]{\setlength{\rightskip}{0pt plus 5cm}void \-\_\-\-\_\-attribute\-\_\-\-\_\- (
\begin{DoxyParamCaption}
\item[{(naked)}]{}
\end{DoxyParamCaption}
)}}\label{thread_8c_abe49956df32d79322d93eb548ff139f3}


In the case where the current thread is preempted by \hyperlink{thread_8c_a09bcca24ab734199ef4456405771e2ad}{caribou\-\_\-thread\-\_\-yield()}, then there is no jiffies counting, otherwise it's the same as the normal scheduler interrupt. If C\-A\-R\-I\-B\-O\-U\-\_\-\-L\-O\-W\-\_\-\-S\-T\-A\-C\-K\-\_\-\-T\-R\-A\-P is defined, stack overflow trapping is performed. 

Entry point for handing a scheduler timer interrupt. Determines which thread is the next runnable on the queue, and switches context. The jiffies counter is incremented and a jiffy is added to the current thread's total run time. If C\-A\-R\-I\-B\-O\-U\-\_\-\-L\-O\-W\-\_\-\-S\-T\-A\-C\-K\-\_\-\-T\-R\-A\-P is defined, stack overflow trapping is performed. 

Definition at line 777 of file thread.\-c.



Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{thread_8c_abe49956df32d79322d93eb548ff139f3_cgraph}
\end{center}
\end{figure}


\hypertarget{thread_8c_a06622b3e7de7c548f6c011ec10d03cef}{\index{thread.\-c@{thread.\-c}!\-\_\-caribou\-\_\-thread\-\_\-fault\-\_\-emit@{\-\_\-caribou\-\_\-thread\-\_\-fault\-\_\-emit}}
\index{\-\_\-caribou\-\_\-thread\-\_\-fault\-\_\-emit@{\-\_\-caribou\-\_\-thread\-\_\-fault\-\_\-emit}!thread.c@{thread.\-c}}
\subsubsection[{\-\_\-caribou\-\_\-thread\-\_\-fault\-\_\-emit}]{\setlength{\rightskip}{0pt plus 5cm}uint16\-\_\-t \-\_\-caribou\-\_\-thread\-\_\-fault\-\_\-emit (
\begin{DoxyParamCaption}
\item[{uint16\-\_\-t}]{flags}
\end{DoxyParamCaption}
)}}\label{thread_8c_a06622b3e7de7c548f6c011ec10d03cef}


Emit a thread fault by calling the faultfn callback function. 



Definition at line 106 of file thread.\-c.



Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{thread_8c_a06622b3e7de7c548f6c011ec10d03cef_icgraph}
\end{center}
\end{figure}


\hypertarget{thread_8c_abca798438c743165fb5b9e06875ed37c}{\index{thread.\-c@{thread.\-c}!\-\_\-swap\-\_\-thread@{\-\_\-swap\-\_\-thread}}
\index{\-\_\-swap\-\_\-thread@{\-\_\-swap\-\_\-thread}!thread.c@{thread.\-c}}
\subsubsection[{\-\_\-swap\-\_\-thread}]{\setlength{\rightskip}{0pt plus 5cm}static void \-\_\-swap\-\_\-thread (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}}\label{thread_8c_abca798438c743165fb5b9e06875ed37c}


Performs the thread scheduling function. Currently a round-\/robin search for the next runnable. 



Definition at line 720 of file thread.\-c.



Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=268pt]{thread_8c_abca798438c743165fb5b9e06875ed37c_icgraph}
\end{center}
\end{figure}


\hypertarget{thread_8c_a8dd1c0055ec5da06cf9eeeafc09c7aa7}{\index{thread.\-c@{thread.\-c}!append\-\_\-thread\-\_\-node@{append\-\_\-thread\-\_\-node}}
\index{append\-\_\-thread\-\_\-node@{append\-\_\-thread\-\_\-node}!thread.c@{thread.\-c}}
\subsubsection[{append\-\_\-thread\-\_\-node}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf caribou\-\_\-thread\-\_\-t}$\ast$ append\-\_\-thread\-\_\-node (
\begin{DoxyParamCaption}
\item[{{\bf caribou\-\_\-thread\-\_\-t} $\ast$}]{node}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{thread_8c_a8dd1c0055ec5da06cf9eeeafc09c7aa7}


Append a thread node to the list. 



Definition at line 181 of file thread.\-c.



Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{thread_8c_a8dd1c0055ec5da06cf9eeeafc09c7aa7_icgraph}
\end{center}
\end{figure}


\hypertarget{thread_8c_a1a176f9b6f0b652714102398843d51ef}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-create@{caribou\-\_\-thread\-\_\-create}}
\index{caribou\-\_\-thread\-\_\-create@{caribou\-\_\-thread\-\_\-create}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-create}]{\setlength{\rightskip}{0pt plus 5cm}{\bf caribou\-\_\-thread\-\_\-t}$\ast$ caribou\-\_\-thread\-\_\-create (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{name, }
\item[{void($\ast$)(void $\ast$)}]{run, }
\item[{void($\ast$)(void $\ast$)}]{finish, }
\item[{void $\ast$}]{arg, }
\item[{void $\ast$}]{stackaddr, }
\item[{int}]{stack\-\_\-size, }
\item[{int16\-\_\-t}]{priority}
\end{DoxyParamCaption}
)}}\label{thread_8c_a1a176f9b6f0b652714102398843d51ef}
Create a new instance of a C\-A\-R\-I\-B\-O\-U thread. 
\begin{DoxyParams}{Parameters}
{\em name} & The ascii name of the thread. This pointer must remain valid for the life span of the thread instance. \\
\hline
{\em run} & A Pointer to the entry point function of the thread. Note the entry point function must accept a void$\ast$ pointer even if it is not used. \\
\hline
{\em finish} & A function which is called up thread termination. \\
\hline
{\em arg} & An argument pointer which is passed to the thread entry point function run. \\
\hline
{\em stackaddr} & A pointer to bottom of the program stack associated with this thread. \\
\hline
{\em stack\-\_\-size} & The size of the stack belonging to this thread. \\
\hline
{\em priority} & The priority of the thread. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A pointer to the newly created thread or N\-U\-L\-L if something failed. 
\end{DoxyReturn}


Definition at line 473 of file thread.\-c.



Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{thread_8c_a1a176f9b6f0b652714102398843d51ef_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{thread_8c_a1a176f9b6f0b652714102398843d51ef_icgraph}
\end{center}
\end{figure}


\hypertarget{thread_8c_a57862b2b48ff010a38d00f9138ff9696}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-current@{caribou\-\_\-thread\-\_\-current}}
\index{caribou\-\_\-thread\-\_\-current@{caribou\-\_\-thread\-\_\-current}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-current}]{\setlength{\rightskip}{0pt plus 5cm}{\bf caribou\-\_\-thread\-\_\-t}$\ast$ caribou\-\_\-thread\-\_\-current (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{thread_8c_a57862b2b48ff010a38d00f9138ff9696}
\begin{DoxyReturn}{Returns}
A pointer to the currently running thread structure. 
\end{DoxyReturn}


Definition at line 553 of file thread.\-c.



Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{thread_8c_a57862b2b48ff010a38d00f9138ff9696_icgraph}
\end{center}
\end{figure}


\hypertarget{thread_8c_a36874085bf0027e821273e0b80e34f0d}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-current\-\_\-arg@{caribou\-\_\-thread\-\_\-current\-\_\-arg}}
\index{caribou\-\_\-thread\-\_\-current\-\_\-arg@{caribou\-\_\-thread\-\_\-current\-\_\-arg}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-current\-\_\-arg}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ caribou\-\_\-thread\-\_\-current\-\_\-arg (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{thread_8c_a36874085bf0027e821273e0b80e34f0d}


return current thread arg 



Definition at line 567 of file thread.\-c.

\hypertarget{thread_8c_ad0596139a6bb38fc3c12be06a9180c4d}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-dump@{caribou\-\_\-thread\-\_\-dump}}
\index{caribou\-\_\-thread\-\_\-dump@{caribou\-\_\-thread\-\_\-dump}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-dump}]{\setlength{\rightskip}{0pt plus 5cm}void caribou\-\_\-thread\-\_\-dump (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{thread_8c_ad0596139a6bb38fc3c12be06a9180c4d}


Definition at line 135 of file thread.\-c.



Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=300pt]{thread_8c_ad0596139a6bb38fc3c12be06a9180c4d_icgraph}
\end{center}
\end{figure}


\hypertarget{thread_8c_aee74a4ed56dec09a5acd9ce8b57de9d8}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-exec@{caribou\-\_\-thread\-\_\-exec}}
\index{caribou\-\_\-thread\-\_\-exec@{caribou\-\_\-thread\-\_\-exec}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-exec}]{\setlength{\rightskip}{0pt plus 5cm}void caribou\-\_\-thread\-\_\-exec (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{thread_8c_aee74a4ed56dec09a5acd9ce8b57de9d8}


Enter into the main thread execution loop. This function does not return. This function should be called once all other threads are created and started. This function has two callbacks board\-\_\-idle() and main\-\_\-idle(). 

main thread exec loop -\/ used by C\-A\-R\-I\-B\-O\-U 

Definition at line 707 of file thread.\-c.



Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{thread_8c_aee74a4ed56dec09a5acd9ce8b57de9d8_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=298pt]{thread_8c_aee74a4ed56dec09a5acd9ce8b57de9d8_icgraph}
\end{center}
\end{figure}


\hypertarget{thread_8c_a38170ad74ec44557654ee5f3996e10f5}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-fault\-\_\-set@{caribou\-\_\-thread\-\_\-fault\-\_\-set}}
\index{caribou\-\_\-thread\-\_\-fault\-\_\-set@{caribou\-\_\-thread\-\_\-fault\-\_\-set}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-fault\-\_\-set}]{\setlength{\rightskip}{0pt plus 5cm}void caribou\-\_\-thread\-\_\-fault\-\_\-set (
\begin{DoxyParamCaption}
\item[{void $\ast$($\ast$)(int, void $\ast$)}]{fn, }
\item[{void $\ast$}]{arg}
\end{DoxyParamCaption}
)}}\label{thread_8c_a38170ad74ec44557654ee5f3996e10f5}


set the thread fault callback handler 



Definition at line 535 of file thread.\-c.

\hypertarget{thread_8c_a82b0c80119cc0a82b8dbfed125a4200d}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-first@{caribou\-\_\-thread\-\_\-first}}
\index{caribou\-\_\-thread\-\_\-first@{caribou\-\_\-thread\-\_\-first}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-first}]{\setlength{\rightskip}{0pt plus 5cm}{\bf caribou\-\_\-thread\-\_\-t}$\ast$ caribou\-\_\-thread\-\_\-first (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{thread_8c_a82b0c80119cc0a82b8dbfed125a4200d}
\begin{DoxyReturn}{Returns}
first thread. 
\end{DoxyReturn}


Definition at line 561 of file thread.\-c.

\hypertarget{thread_8c_aff2beb27359679c25e9a01c1d0bf0f88}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-init@{caribou\-\_\-thread\-\_\-init}}
\index{caribou\-\_\-thread\-\_\-init@{caribou\-\_\-thread\-\_\-init}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}{\bf caribou\-\_\-thread\-\_\-t}$\ast$ caribou\-\_\-thread\-\_\-init (
\begin{DoxyParamCaption}
\item[{int16\-\_\-t}]{priority}
\end{DoxyParamCaption}
)}}\label{thread_8c_aff2beb27359679c25e9a01c1d0bf0f88}


Initialize the thread system with priority of main thread, this creates the main 'caribou' thread. 



Definition at line 599 of file thread.\-c.



Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{thread_8c_aff2beb27359679c25e9a01c1d0bf0f88_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=280pt]{thread_8c_aff2beb27359679c25e9a01c1d0bf0f88_icgraph}
\end{center}
\end{figure}


\hypertarget{thread_8c_a81ec8b7e5f2accca0c462337830fbdf5}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-lock@{caribou\-\_\-thread\-\_\-lock}}
\index{caribou\-\_\-thread\-\_\-lock@{caribou\-\_\-thread\-\_\-lock}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-lock}]{\setlength{\rightskip}{0pt plus 5cm}int caribou\-\_\-thread\-\_\-lock (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{thread_8c_a81ec8b7e5f2accca0c462337830fbdf5}


Lock the current thread such that it will not yield C\-P\-U time until such time that the thread is unlocked by \hyperlink{thread_8c_a0b4d0cd341028e7713f6f0f60a018529}{caribou\-\_\-thread\-\_\-unlock()}. Needless to say this should generally be used sparingly. 

\begin{DoxyReturn}{Returns}
The current state of the lock. 
\end{DoxyReturn}


Definition at line 265 of file thread.\-c.



Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{thread_8c_a81ec8b7e5f2accca0c462337830fbdf5_icgraph}
\end{center}
\end{figure}


\hypertarget{thread_8c_a013385b5f8859b297532a624c53e3425}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-locked@{caribou\-\_\-thread\-\_\-locked}}
\index{caribou\-\_\-thread\-\_\-locked@{caribou\-\_\-thread\-\_\-locked}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-locked}]{\setlength{\rightskip}{0pt plus 5cm}int caribou\-\_\-thread\-\_\-locked (
\begin{DoxyParamCaption}
\item[{{\bf caribou\-\_\-thread\-\_\-t} $\ast$}]{thread}
\end{DoxyParamCaption}
)}}\label{thread_8c_a013385b5f8859b297532a624c53e3425}


Determine of the current thread is locked? 

\begin{DoxyReturn}{Returns}
The current state of the lock. 
\end{DoxyReturn}


Definition at line 308 of file thread.\-c.

\hypertarget{thread_8c_a7844554aa2275022d4376aafe8e55133}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-name@{caribou\-\_\-thread\-\_\-name}}
\index{caribou\-\_\-thread\-\_\-name@{caribou\-\_\-thread\-\_\-name}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-name}]{\setlength{\rightskip}{0pt plus 5cm}const char$\ast$ caribou\-\_\-thread\-\_\-name (
\begin{DoxyParamCaption}
\item[{{\bf caribou\-\_\-thread\-\_\-t} $\ast$}]{thread}
\end{DoxyParamCaption}
)}}\label{thread_8c_a7844554aa2275022d4376aafe8e55133}


return the thread name pointer 



Definition at line 373 of file thread.\-c.

\hypertarget{thread_8c_aa85093539f7bb9e2c7124a2011e60279}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-once@{caribou\-\_\-thread\-\_\-once}}
\index{caribou\-\_\-thread\-\_\-once@{caribou\-\_\-thread\-\_\-once}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-once}]{\setlength{\rightskip}{0pt plus 5cm}void caribou\-\_\-thread\-\_\-once (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{thread_8c_aa85093539f7bb9e2c7124a2011e60279}


wait for interrupt 



Definition at line 681 of file thread.\-c.



Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{thread_8c_aa85093539f7bb9e2c7124a2011e60279_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{thread_8c_aa85093539f7bb9e2c7124a2011e60279_icgraph}
\end{center}
\end{figure}


\hypertarget{thread_8c_a0699ae479cf385b908f07e667cde6644}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-parent@{caribou\-\_\-thread\-\_\-parent}}
\index{caribou\-\_\-thread\-\_\-parent@{caribou\-\_\-thread\-\_\-parent}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-parent}]{\setlength{\rightskip}{0pt plus 5cm}{\bf caribou\-\_\-thread\-\_\-t}$\ast$ caribou\-\_\-thread\-\_\-parent (
\begin{DoxyParamCaption}
\item[{{\bf caribou\-\_\-thread\-\_\-t} $\ast$}]{thread}
\end{DoxyParamCaption}
)}}\label{thread_8c_a0699ae479cf385b908f07e667cde6644}


return the parent thread 



Definition at line 403 of file thread.\-c.

\hypertarget{thread_8c_ad54c3c302155c7e96aea192b84ac9849}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-priority@{caribou\-\_\-thread\-\_\-priority}}
\index{caribou\-\_\-thread\-\_\-priority@{caribou\-\_\-thread\-\_\-priority}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-priority}]{\setlength{\rightskip}{0pt plus 5cm}int16\-\_\-t caribou\-\_\-thread\-\_\-priority (
\begin{DoxyParamCaption}
\item[{{\bf caribou\-\_\-thread\-\_\-t} $\ast$}]{thread}
\end{DoxyParamCaption}
)}}\label{thread_8c_ad54c3c302155c7e96aea192b84ac9849}
\begin{DoxyReturn}{Returns}
The thread priority of the current thread. 
\end{DoxyReturn}


Definition at line 590 of file thread.\-c.

\hypertarget{thread_8c_a1697829758e997aa744256133717a13f}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-root@{caribou\-\_\-thread\-\_\-root}}
\index{caribou\-\_\-thread\-\_\-root@{caribou\-\_\-thread\-\_\-root}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-root}]{\setlength{\rightskip}{0pt plus 5cm}{\bf caribou\-\_\-thread\-\_\-t}$\ast$ caribou\-\_\-thread\-\_\-root (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{thread_8c_a1697829758e997aa744256133717a13f}
\begin{DoxyReturn}{Returns}
a pointer to the root thread, normally the 'caribou' thread. 
\end{DoxyReturn}


Definition at line 545 of file thread.\-c.

\hypertarget{thread_8c_a90c760a6e205cfb112f2f9cef25da878}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-runtime@{caribou\-\_\-thread\-\_\-runtime}}
\index{caribou\-\_\-thread\-\_\-runtime@{caribou\-\_\-thread\-\_\-runtime}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-runtime}]{\setlength{\rightskip}{0pt plus 5cm}uint64\-\_\-t caribou\-\_\-thread\-\_\-runtime (
\begin{DoxyParamCaption}
\item[{{\bf caribou\-\_\-thread\-\_\-t} $\ast$}]{thread}
\end{DoxyParamCaption}
)}}\label{thread_8c_a90c760a6e205cfb112f2f9cef25da878}


return the thread's runtime in jiffies 



Definition at line 379 of file thread.\-c.

\hypertarget{thread_8c_a6880536f791e0362675c3b11a9f2d2fb}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-schedule@{caribou\-\_\-thread\-\_\-schedule}}
\index{caribou\-\_\-thread\-\_\-schedule@{caribou\-\_\-thread\-\_\-schedule}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-schedule}]{\setlength{\rightskip}{0pt plus 5cm}void caribou\-\_\-thread\-\_\-schedule (
\begin{DoxyParamCaption}
\item[{{\bf caribou\-\_\-thread\-\_\-t} $\ast$}]{thread}
\end{DoxyParamCaption}
)}}\label{thread_8c_a6880536f791e0362675c3b11a9f2d2fb}


Schedule a thread to run next. The specified thread will be queued to run on the next context switch. If it is desired to schedule the thread to run immediately, then follow the \hyperlink{thread_8c_a6880536f791e0362675c3b11a9f2d2fb}{caribou\-\_\-thread\-\_\-schedule()} call with a call to \hyperlink{thread_8c_a09bcca24ab734199ef4456405771e2ad}{caribou\-\_\-thread\-\_\-yield()}. 


\begin{DoxyParams}{Parameters}
{\em thread} & The thread to schedule to run next. \\
\hline
\end{DoxyParams}


Definition at line 616 of file thread.\-c.



Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{thread_8c_a6880536f791e0362675c3b11a9f2d2fb_cgraph}
\end{center}
\end{figure}


\hypertarget{thread_8c_a951b092d28660f5e3a9893d671c4c6a6}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-set\-\_\-name@{caribou\-\_\-thread\-\_\-set\-\_\-name}}
\index{caribou\-\_\-thread\-\_\-set\-\_\-name@{caribou\-\_\-thread\-\_\-set\-\_\-name}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-set\-\_\-name}]{\setlength{\rightskip}{0pt plus 5cm}const char$\ast$ caribou\-\_\-thread\-\_\-set\-\_\-name (
\begin{DoxyParamCaption}
\item[{{\bf caribou\-\_\-thread\-\_\-t} $\ast$}]{thread, }
\item[{const char $\ast$}]{name}
\end{DoxyParamCaption}
)}}\label{thread_8c_a951b092d28660f5e3a9893d671c4c6a6}


Set a pointer to the thread's name. 



Definition at line 366 of file thread.\-c.

\hypertarget{thread_8c_abc2776e9b90a3d12dd21aeafcf7149fc}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-set\-\_\-priority@{caribou\-\_\-thread\-\_\-set\-\_\-priority}}
\index{caribou\-\_\-thread\-\_\-set\-\_\-priority@{caribou\-\_\-thread\-\_\-set\-\_\-priority}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-set\-\_\-priority}]{\setlength{\rightskip}{0pt plus 5cm}void caribou\-\_\-thread\-\_\-set\-\_\-priority (
\begin{DoxyParamCaption}
\item[{{\bf caribou\-\_\-thread\-\_\-t} $\ast$}]{thread, }
\item[{int16\-\_\-t}]{prio}
\end{DoxyParamCaption}
)}}\label{thread_8c_abc2776e9b90a3d12dd21aeafcf7149fc}


Set the priority of the current thread. 


\begin{DoxyParams}{Parameters}
{\em thread} & A pointer to the target thread. \\
\hline
{\em prio} & The priority to assign to the thread in terms of additional scheduling slots assigned to the thread. For instance, 0 means to perform a switch the thread upon the next context switch interrupt, and 1 means to add one additional context cycle to the thread's run-\/time. \\
\hline
\end{DoxyParams}


Definition at line 580 of file thread.\-c.

\hypertarget{thread_8c_a58f74a5d00bc66769898ee8ea9df8c4e}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-sleep@{caribou\-\_\-thread\-\_\-sleep}}
\index{caribou\-\_\-thread\-\_\-sleep@{caribou\-\_\-thread\-\_\-sleep}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-sleep}]{\setlength{\rightskip}{0pt plus 5cm}void caribou\-\_\-thread\-\_\-sleep (
\begin{DoxyParamCaption}
\item[{{\bf caribou\-\_\-thread\-\_\-t} $\ast$}]{thread, }
\item[{{\bf caribou\-\_\-tick\-\_\-t}}]{ticks}
\end{DoxyParamCaption}
)}}\label{thread_8c_a58f74a5d00bc66769898ee8ea9df8c4e}
Sleep another thread for a number of clock ticks. 
\begin{DoxyParams}{Parameters}
{\em thread} & The thread to put to sleep. \\
\hline
{\em ticks} & Number of jiffies to sleep for. A zero (0) value indicates forever or until woken up the \hyperlink{thread_8c_ac48bcd661762d85fe2197d29f65b20b7}{caribou\-\_\-thread\-\_\-wakeup()} function. \\
\hline
\end{DoxyParams}


Definition at line 326 of file thread.\-c.



Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{thread_8c_a58f74a5d00bc66769898ee8ea9df8c4e_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=336pt]{thread_8c_a58f74a5d00bc66769898ee8ea9df8c4e_icgraph}
\end{center}
\end{figure}


\hypertarget{thread_8c_a8ec8d3ea7e7b5f2e9af43bdec60e2e00}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-sleep\-\_\-current@{caribou\-\_\-thread\-\_\-sleep\-\_\-current}}
\index{caribou\-\_\-thread\-\_\-sleep\-\_\-current@{caribou\-\_\-thread\-\_\-sleep\-\_\-current}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-sleep\-\_\-current}]{\setlength{\rightskip}{0pt plus 5cm}void caribou\-\_\-thread\-\_\-sleep\-\_\-current (
\begin{DoxyParamCaption}
\item[{{\bf caribou\-\_\-tick\-\_\-t}}]{ticks}
\end{DoxyParamCaption}
)}}\label{thread_8c_a8ec8d3ea7e7b5f2e9af43bdec60e2e00}
Sleep the current thread for a number of clock ticks. 
\begin{DoxyParams}{Parameters}
{\em thread} & The thread to put to sleep. A zero (0) value indicates forever or until woken up the \hyperlink{thread_8c_ac48bcd661762d85fe2197d29f65b20b7}{caribou\-\_\-thread\-\_\-wakeup()} function. \\
\hline
{\em ticks} & Number of jiffies to sleep for. Forever or until woken up if ticks==0. \\
\hline
\end{DoxyParams}


Definition at line 351 of file thread.\-c.



Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{thread_8c_a8ec8d3ea7e7b5f2e9af43bdec60e2e00_cgraph}
\end{center}
\end{figure}


\hypertarget{thread_8c_a9f72098ff907a9804be262770df5983f}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-stacksize@{caribou\-\_\-thread\-\_\-stacksize}}
\index{caribou\-\_\-thread\-\_\-stacksize@{caribou\-\_\-thread\-\_\-stacksize}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-stacksize}]{\setlength{\rightskip}{0pt plus 5cm}uint32\-\_\-t caribou\-\_\-thread\-\_\-stacksize (
\begin{DoxyParamCaption}
\item[{{\bf caribou\-\_\-thread\-\_\-t} $\ast$}]{thread}
\end{DoxyParamCaption}
)}}\label{thread_8c_a9f72098ff907a9804be262770df5983f}


return the thread's stack size in bytes. 



Definition at line 385 of file thread.\-c.

\hypertarget{thread_8c_a793c0c72a1bb908848ef2e3353167768}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-stackusage@{caribou\-\_\-thread\-\_\-stackusage}}
\index{caribou\-\_\-thread\-\_\-stackusage@{caribou\-\_\-thread\-\_\-stackusage}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-stackusage}]{\setlength{\rightskip}{0pt plus 5cm}uint32\-\_\-t caribou\-\_\-thread\-\_\-stackusage (
\begin{DoxyParamCaption}
\item[{{\bf caribou\-\_\-thread\-\_\-t} $\ast$}]{thread}
\end{DoxyParamCaption}
)}}\label{thread_8c_a793c0c72a1bb908848ef2e3353167768}


return the task's stack usage in bytes. 



Definition at line 391 of file thread.\-c.

\hypertarget{thread_8c_aa035cea6301e74d288e0d3f37d6759a2}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-state@{caribou\-\_\-thread\-\_\-state}}
\index{caribou\-\_\-thread\-\_\-state@{caribou\-\_\-thread\-\_\-state}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-state}]{\setlength{\rightskip}{0pt plus 5cm}uint16\-\_\-t caribou\-\_\-thread\-\_\-state (
\begin{DoxyParamCaption}
\item[{{\bf caribou\-\_\-thread\-\_\-t} $\ast$}]{thread}
\end{DoxyParamCaption}
)}}\label{thread_8c_aa035cea6301e74d288e0d3f37d6759a2}


return the task's state 



Definition at line 397 of file thread.\-c.

\hypertarget{thread_8c_a005298b8a4907a4f4523925d7ed1a8f4}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-terminate@{caribou\-\_\-thread\-\_\-terminate}}
\index{caribou\-\_\-thread\-\_\-terminate@{caribou\-\_\-thread\-\_\-terminate}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-terminate}]{\setlength{\rightskip}{0pt plus 5cm}void caribou\-\_\-thread\-\_\-terminate (
\begin{DoxyParamCaption}
\item[{{\bf caribou\-\_\-thread\-\_\-t} $\ast$}]{thread}
\end{DoxyParamCaption}
)}}\label{thread_8c_a005298b8a4907a4f4523925d7ed1a8f4}


Schedules a thread to be terminate upon the next execution of the main thread idle loop. The thread's finish callback is executed, in which case the thread is responsible for releasing any resources it may have allocated. Thread timers will automatically be stopped and disposed. 


\begin{DoxyParams}{Parameters}
{\em thread} & The thread to be scheduled for termination. \\
\hline
\end{DoxyParams}


Definition at line 432 of file thread.\-c.



Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{thread_8c_a005298b8a4907a4f4523925d7ed1a8f4_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{thread_8c_a005298b8a4907a4f4523925d7ed1a8f4_icgraph}
\end{center}
\end{figure}


\hypertarget{thread_8c_a0b4d0cd341028e7713f6f0f60a018529}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-unlock@{caribou\-\_\-thread\-\_\-unlock}}
\index{caribou\-\_\-thread\-\_\-unlock@{caribou\-\_\-thread\-\_\-unlock}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-unlock}]{\setlength{\rightskip}{0pt plus 5cm}int caribou\-\_\-thread\-\_\-unlock (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{thread_8c_a0b4d0cd341028e7713f6f0f60a018529}


Unlock a thread which has been previously been locked with \hyperlink{thread_8c_a81ec8b7e5f2accca0c462337830fbdf5}{caribou\-\_\-thread\-\_\-lock()} 

\begin{DoxyReturn}{Returns}
The current state of the lock. 
\end{DoxyReturn}


Definition at line 282 of file thread.\-c.



Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{thread_8c_a0b4d0cd341028e7713f6f0f60a018529_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{thread_8c_a0b4d0cd341028e7713f6f0f60a018529_icgraph}
\end{center}
\end{figure}


\hypertarget{thread_8c_ac48bcd661762d85fe2197d29f65b20b7}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-wakeup@{caribou\-\_\-thread\-\_\-wakeup}}
\index{caribou\-\_\-thread\-\_\-wakeup@{caribou\-\_\-thread\-\_\-wakeup}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-wakeup}]{\setlength{\rightskip}{0pt plus 5cm}void caribou\-\_\-thread\-\_\-wakeup (
\begin{DoxyParamCaption}
\item[{{\bf caribou\-\_\-thread\-\_\-t} $\ast$}]{thread}
\end{DoxyParamCaption}
)}}\label{thread_8c_ac48bcd661762d85fe2197d29f65b20b7}
Wake a thread previously put to sleep with \hyperlink{thread_8c_a58f74a5d00bc66769898ee8ea9df8c4e}{caribou\-\_\-thread\-\_\-sleep()}. 
\begin{DoxyParams}{Parameters}
{\em thread} & The thread to wake up. \\
\hline
\end{DoxyParams}


Definition at line 358 of file thread.\-c.



Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{thread_8c_ac48bcd661762d85fe2197d29f65b20b7_cgraph}
\end{center}
\end{figure}


\hypertarget{thread_8c_a148dbcc4c04bf688168d217bc97730a2}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-wfi@{caribou\-\_\-thread\-\_\-wfi}}
\index{caribou\-\_\-thread\-\_\-wfi@{caribou\-\_\-thread\-\_\-wfi}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-wfi}]{\setlength{\rightskip}{0pt plus 5cm}void caribou\-\_\-thread\-\_\-wfi (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{thread_8c_a148dbcc4c04bf688168d217bc97730a2}


A wrapper for the hardware \char`\"{}\-Wait For Interrupt\char`\"{} function chip\-\_\-wfi(). 

for debugging, dump the thread list to stdout 

Definition at line 411 of file thread.\-c.

\hypertarget{thread_8c_a09bcca24ab734199ef4456405771e2ad}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-thread\-\_\-yield@{caribou\-\_\-thread\-\_\-yield}}
\index{caribou\-\_\-thread\-\_\-yield@{caribou\-\_\-thread\-\_\-yield}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-thread\-\_\-yield}]{\setlength{\rightskip}{0pt plus 5cm}void caribou\-\_\-thread\-\_\-yield (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{thread_8c_a09bcca24ab734199ef4456405771e2ad}


The remainder of the scheduled time slots for the current thread are disposed and the next runnable thread in the queue is scheduled. 



Definition at line 420 of file thread.\-c.



Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=312pt]{thread_8c_a09bcca24ab734199ef4456405771e2ad_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{thread_8c_a09bcca24ab734199ef4456405771e2ad_icgraph}
\end{center}
\end{figure}


\hypertarget{thread_8c_a3f8a853d30c98c2a756adf6920307208}{\index{thread.\-c@{thread.\-c}!check\-\_\-sp@{check\-\_\-sp}}
\index{check\-\_\-sp@{check\-\_\-sp}!thread.c@{thread.\-c}}
\subsubsection[{check\-\_\-sp}]{\setlength{\rightskip}{0pt plus 5cm}static void check\-\_\-sp (
\begin{DoxyParamCaption}
\item[{{\bf caribou\-\_\-thread\-\_\-t} $\ast$}]{thread}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{thread_8c_a3f8a853d30c98c2a756adf6920307208}


Definition at line 656 of file thread.\-c.



Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=310pt]{thread_8c_a3f8a853d30c98c2a756adf6920307208_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{thread_8c_a3f8a853d30c98c2a756adf6920307208_icgraph}
\end{center}
\end{figure}


\hypertarget{thread_8c_aef758d9fcc426b2069d6e5ed7ed2ed0f}{\index{thread.\-c@{thread.\-c}!delete\-\_\-thread\-\_\-node@{delete\-\_\-thread\-\_\-node}}
\index{delete\-\_\-thread\-\_\-node@{delete\-\_\-thread\-\_\-node}!thread.c@{thread.\-c}}
\subsubsection[{delete\-\_\-thread\-\_\-node}]{\setlength{\rightskip}{0pt plus 5cm}static void delete\-\_\-thread\-\_\-node (
\begin{DoxyParamCaption}
\item[{{\bf caribou\-\_\-thread\-\_\-t} $\ast$}]{node}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{thread_8c_aef758d9fcc426b2069d6e5ed7ed2ed0f}


Dispose of a thread node. 



Definition at line 173 of file thread.\-c.



Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=252pt]{thread_8c_aef758d9fcc426b2069d6e5ed7ed2ed0f_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{thread_8c_aef758d9fcc426b2069d6e5ed7ed2ed0f_icgraph}
\end{center}
\end{figure}


\hypertarget{thread_8c_a0b72fd6b15677067d5d231ace4070498}{\index{thread.\-c@{thread.\-c}!fault\-\_\-clear@{fault\-\_\-clear}}
\index{fault\-\_\-clear@{fault\-\_\-clear}!thread.c@{thread.\-c}}
\subsubsection[{fault\-\_\-clear}]{\setlength{\rightskip}{0pt plus 5cm}static uint16\-\_\-t fault\-\_\-clear (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{thread_8c_a0b72fd6b15677067d5d231ace4070498}


Clear the fault flags. The current thread is locked prior to setting the lags, and is unlocked after the flags have been set. 



Definition at line 82 of file thread.\-c.

\hypertarget{thread_8c_a2e21dedab93924499a818d5919126b21}{\index{thread.\-c@{thread.\-c}!fault\-\_\-set@{fault\-\_\-set}}
\index{fault\-\_\-set@{fault\-\_\-set}!thread.c@{thread.\-c}}
\subsubsection[{fault\-\_\-set}]{\setlength{\rightskip}{0pt plus 5cm}static uint16\-\_\-t fault\-\_\-set (
\begin{DoxyParamCaption}
\item[{uint16\-\_\-t}]{flags}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{thread_8c_a2e21dedab93924499a818d5919126b21}


Set a fault flag. The current thread is locked prior to setting the lags, and is unlocked after the flags have been set. 



Definition at line 94 of file thread.\-c.

\hypertarget{thread_8c_a5cecb0c75bb0ab2a0a4b1f1e30d6c5bf}{\index{thread.\-c@{thread.\-c}!find\-\_\-child\-\_\-thread\-\_\-node@{find\-\_\-child\-\_\-thread\-\_\-node}}
\index{find\-\_\-child\-\_\-thread\-\_\-node@{find\-\_\-child\-\_\-thread\-\_\-node}!thread.c@{thread.\-c}}
\subsubsection[{find\-\_\-child\-\_\-thread\-\_\-node}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf caribou\-\_\-thread\-\_\-t}$\ast$ find\-\_\-child\-\_\-thread\-\_\-node (
\begin{DoxyParamCaption}
\item[{{\bf caribou\-\_\-thread\-\_\-t} $\ast$}]{parent}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{thread_8c_a5cecb0c75bb0ab2a0a4b1f1e30d6c5bf}


locate next child 



Definition at line 242 of file thread.\-c.

\hypertarget{thread_8c_a457d03e540372537caa26ddc9244ca15}{\index{thread.\-c@{thread.\-c}!insert\-\_\-thread\-\_\-node@{insert\-\_\-thread\-\_\-node}}
\index{insert\-\_\-thread\-\_\-node@{insert\-\_\-thread\-\_\-node}!thread.c@{thread.\-c}}
\subsubsection[{insert\-\_\-thread\-\_\-node}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf caribou\-\_\-thread\-\_\-t}$\ast$ insert\-\_\-thread\-\_\-node (
\begin{DoxyParamCaption}
\item[{{\bf caribou\-\_\-thread\-\_\-t} $\ast$}]{node, }
\item[{{\bf caribou\-\_\-thread\-\_\-t} $\ast$}]{after}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{thread_8c_a457d03e540372537caa26ddc9244ca15}


Append a thread node to the list. 



Definition at line 205 of file thread.\-c.



Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=342pt]{thread_8c_a457d03e540372537caa26ddc9244ca15_icgraph}
\end{center}
\end{figure}


\hypertarget{thread_8c_aad2dda8acbccc8a86e400143d1ac913c}{\index{thread.\-c@{thread.\-c}!new\-\_\-thread\-\_\-node@{new\-\_\-thread\-\_\-node}}
\index{new\-\_\-thread\-\_\-node@{new\-\_\-thread\-\_\-node}!thread.c@{thread.\-c}}
\subsubsection[{new\-\_\-thread\-\_\-node}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf caribou\-\_\-thread\-\_\-t}$\ast$ new\-\_\-thread\-\_\-node (
\begin{DoxyParamCaption}
\item[{{\bf caribou\-\_\-thread\-\_\-t} $\ast$}]{parent}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{thread_8c_aad2dda8acbccc8a86e400143d1ac913c}


Allocate and initialize a thread node. 

parent A pointer to the parent thread node, or N\-U\-L\-L. \begin{DoxyNote}{Note}
T\-H\-R\-E\-A\-D\-\_\-\-F\-A\-U\-L\-T\-\_\-\-A\-L\-L\-O\-C\-\_\-\-F\-A\-I\-L\-U\-R\-E is emitted upon allocation failure. 
\end{DoxyNote}


Definition at line 155 of file thread.\-c.



Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=344pt]{thread_8c_aad2dda8acbccc8a86e400143d1ac913c_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{thread_8c_aad2dda8acbccc8a86e400143d1ac913c_icgraph}
\end{center}
\end{figure}


\hypertarget{thread_8c_afc25d21e4e56f62c9dcd93e86225c863}{\index{thread.\-c@{thread.\-c}!remove\-\_\-thread\-\_\-node@{remove\-\_\-thread\-\_\-node}}
\index{remove\-\_\-thread\-\_\-node@{remove\-\_\-thread\-\_\-node}!thread.c@{thread.\-c}}
\subsubsection[{remove\-\_\-thread\-\_\-node}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf caribou\-\_\-thread\-\_\-t}$\ast$ remove\-\_\-thread\-\_\-node (
\begin{DoxyParamCaption}
\item[{{\bf caribou\-\_\-thread\-\_\-t} $\ast$}]{node}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{thread_8c_afc25d21e4e56f62c9dcd93e86225c863}


Remove a thread node from the list. 



Definition at line 218 of file thread.\-c.



Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{thread_8c_afc25d21e4e56f62c9dcd93e86225c863_icgraph}
\end{center}
\end{figure}


\hypertarget{thread_8c_a84c100abfd8a8df4f85158a8a2f26321}{\index{thread.\-c@{thread.\-c}!runtimers@{runtimers}}
\index{runtimers@{runtimers}!thread.c@{thread.\-c}}
\subsubsection[{runtimers}]{\setlength{\rightskip}{0pt plus 5cm}static void runtimers (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{thread_8c_a84c100abfd8a8df4f85158a8a2f26321}


Forward declaration for the private \hyperlink{thread_8c_a84c100abfd8a8df4f85158a8a2f26321}{runtimers()} function. 

\hypertarget{thread_8c_af746aba071850ea86575dcef750949d0}{\index{thread.\-c@{thread.\-c}!thread\-\_\-finish@{thread\-\_\-finish}}
\index{thread\-\_\-finish@{thread\-\_\-finish}!thread.c@{thread.\-c}}
\subsubsection[{thread\-\_\-finish}]{\setlength{\rightskip}{0pt plus 5cm}void thread\-\_\-finish (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{thread_8c_af746aba071850ea86575dcef750949d0}


Get here if a thread returns from it's run() function, wait to die. 



Definition at line 450 of file thread.\-c.



Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{thread_8c_af746aba071850ea86575dcef750949d0_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{thread_8c_af746aba071850ea86575dcef750949d0_icgraph}
\end{center}
\end{figure}




\subsection{Variable Documentation}
\hypertarget{thread_8c_aa8aa5ad03b209f6ba8bc8c4b5933345f}{\index{thread.\-c@{thread.\-c}!\-\_\-\-\_\-main\-\_\-thread\-\_\-stack\-\_\-base\-\_\-\-\_\-@{\-\_\-\-\_\-main\-\_\-thread\-\_\-stack\-\_\-base\-\_\-\-\_\-}}
\index{\-\_\-\-\_\-main\-\_\-thread\-\_\-stack\-\_\-base\-\_\-\-\_\-@{\-\_\-\-\_\-main\-\_\-thread\-\_\-stack\-\_\-base\-\_\-\-\_\-}!thread.c@{thread.\-c}}
\subsubsection[{\-\_\-\-\_\-main\-\_\-thread\-\_\-stack\-\_\-base\-\_\-\-\_\-}]{\setlength{\rightskip}{0pt plus 5cm}uint32\-\_\-t \-\_\-\-\_\-main\-\_\-thread\-\_\-stack\-\_\-base\-\_\-\-\_\-}}\label{thread_8c_aa8aa5ad03b209f6ba8bc8c4b5933345f}


External reference to the main thread stack base, normally defined in the linker script. 

\hypertarget{thread_8c_ad7ed8a105e4aa389b28a3d4efd6e7596}{\index{thread.\-c@{thread.\-c}!\-\_\-\-\_\-main\-\_\-thread\-\_\-stack\-\_\-end\-\_\-\-\_\-@{\-\_\-\-\_\-main\-\_\-thread\-\_\-stack\-\_\-end\-\_\-\-\_\-}}
\index{\-\_\-\-\_\-main\-\_\-thread\-\_\-stack\-\_\-end\-\_\-\-\_\-@{\-\_\-\-\_\-main\-\_\-thread\-\_\-stack\-\_\-end\-\_\-\-\_\-}!thread.c@{thread.\-c}}
\subsubsection[{\-\_\-\-\_\-main\-\_\-thread\-\_\-stack\-\_\-end\-\_\-\-\_\-}]{\setlength{\rightskip}{0pt plus 5cm}uint32\-\_\-t \-\_\-\-\_\-main\-\_\-thread\-\_\-stack\-\_\-end\-\_\-\-\_\-}}\label{thread_8c_ad7ed8a105e4aa389b28a3d4efd6e7596}


External reference to the main thread stack base (top), normally defined in the linker script. 

\hypertarget{thread_8c_a4e721aeae2f22d803b0b29e8c82f84cb}{\index{thread.\-c@{thread.\-c}!\-\_\-\-\_\-process\-\_\-stack\-\_\-base\-\_\-\-\_\-@{\-\_\-\-\_\-process\-\_\-stack\-\_\-base\-\_\-\-\_\-}}
\index{\-\_\-\-\_\-process\-\_\-stack\-\_\-base\-\_\-\-\_\-@{\-\_\-\-\_\-process\-\_\-stack\-\_\-base\-\_\-\-\_\-}!thread.c@{thread.\-c}}
\subsubsection[{\-\_\-\-\_\-process\-\_\-stack\-\_\-base\-\_\-\-\_\-}]{\setlength{\rightskip}{0pt plus 5cm}uint32\-\_\-t \-\_\-\-\_\-process\-\_\-stack\-\_\-base\-\_\-\-\_\-}}\label{thread_8c_a4e721aeae2f22d803b0b29e8c82f84cb}


External reference to the process stack base, normally defined in the linker script. 

\hypertarget{thread_8c_ae60172d0f068a9453447bec8e102bdcb}{\index{thread.\-c@{thread.\-c}!\-\_\-\-\_\-process\-\_\-stack\-\_\-end\-\_\-\-\_\-@{\-\_\-\-\_\-process\-\_\-stack\-\_\-end\-\_\-\-\_\-}}
\index{\-\_\-\-\_\-process\-\_\-stack\-\_\-end\-\_\-\-\_\-@{\-\_\-\-\_\-process\-\_\-stack\-\_\-end\-\_\-\-\_\-}!thread.c@{thread.\-c}}
\subsubsection[{\-\_\-\-\_\-process\-\_\-stack\-\_\-end\-\_\-\-\_\-}]{\setlength{\rightskip}{0pt plus 5cm}uint32\-\_\-t \-\_\-\-\_\-process\-\_\-stack\-\_\-end\-\_\-\-\_\-}}\label{thread_8c_ae60172d0f068a9453447bec8e102bdcb}


External reference to the process stack end (top), normally defined in the linker script. 

\hypertarget{thread_8c_a3c2ea18e6c8d46571011cf28be234e15}{\index{thread.\-c@{thread.\-c}!caribou\-\_\-state@{caribou\-\_\-state}}
\index{caribou\-\_\-state@{caribou\-\_\-state}!thread.c@{thread.\-c}}
\subsubsection[{caribou\-\_\-state}]{\setlength{\rightskip}{0pt plus 5cm}{\bf caribou\-\_\-state\-\_\-t} caribou\-\_\-state}}\label{thread_8c_a3c2ea18e6c8d46571011cf28be234e15}


An instance o the current thread state. 

An instance o the current thread state. 

Definition at line 29 of file thread.\-c.


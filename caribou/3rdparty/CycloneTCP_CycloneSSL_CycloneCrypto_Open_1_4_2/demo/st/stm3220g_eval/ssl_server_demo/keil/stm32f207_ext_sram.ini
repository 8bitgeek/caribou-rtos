//*******************************************************************
//* STM32F207 initialization file (running code from external SRAM) *
//*******************************************************************

FUNC void initExtSram()
{
   _WDWORD(0x40023830, 0x00000078); //RCC_AHB1ENR
   _WDWORD(0x40023838, 0x00000001); //RCC_AHB3ENR
   
   _WDWORD(0x40020C00, 0xAAAA0A0A); //GPIOD_MODER
   _WDWORD(0x40020C04, 0x00000000); //GPIOD_OTYPER
   _WDWORD(0x40020C08, 0xFFFF0F0F); //GPIOD_OSPEEDR
   _WDWORD(0x40020C0C, 0x00000000); //GPIOD_PUPDR
   _WDWORD(0x40020C20, 0x00CC00CC); //GPIOD_AFRL
   _WDWORD(0x40020C24, 0xCCCCCCCC); //GPIOD_AFRH
   
   _WDWORD(0x40021000, 0xAAAA828A); //GPIOE_MODER
   _WDWORD(0x40021004, 0x00000000); //GPIOE_OTYPER
   _WDWORD(0x40021008, 0xFFFFC3CF); //GPIOE_OSPEEDR
   _WDWORD(0x4002100C, 0x00000000); //GPIOE_PUPDR
   _WDWORD(0x40021020, 0xC00CC0CC); //GPIOE_AFRL
   _WDWORD(0x40021024, 0xCCCCCCCC); //GPIOE_AFRH
   
   _WDWORD(0x40021400, 0xAA000AAA); //GPIOF_MODER
   _WDWORD(0x40021404, 0x00000000); //GPIOF_OTYPER
   _WDWORD(0x40021408, 0xFF000FFF); //GPIOF_OSPEEDR
   _WDWORD(0x4002140C, 0x00000000); //GPIOF_PUPDR
   _WDWORD(0x40021420, 0x00CCCCCC); //GPIOF_AFRL
   _WDWORD(0x40021424, 0xCCCC0000); //GPIOF_AFRH
   
   _WDWORD(0x40021800, 0x00080AAA); //GPIOG_MODER
   _WDWORD(0x40021804, 0x00000000); //GPIOG_OTYPER
   _WDWORD(0x40021808, 0x000C0FFF); //GPIOG_OSPEEDR
   _WDWORD(0x4002180C, 0x00000000); //GPIOG_PUPDR
   _WDWORD(0x40021820, 0x00CCCCCC); //GPIOG_AFRL
   _WDWORD(0x40021824, 0x000000C0); //GPIOG_AFRH
   
   _WDWORD(0xA0000008, 0x00001015); //BTCR[2]
   _WDWORD(0xA000000C, 0x00010400); //BTCR[3]
   _WDWORD(0xA000010C, 0x0FFFFFFF); //BWTR[2]
}

//External RAM initialization
initExtSram();

//Load object file
LOAD ssl_server_demo_ext_sram\ssl_server_demo_ext_sram.axf INCREMENTAL

//Setup Vector Table Offset Register
_WDWORD(0xE000ED08, 0x20000000);

//Setup stack pointer
SP = _RDWORD(0x20000000);

//Setup program counter
PC = _RDWORD(0x20000004);

//Run to main
G ,main
